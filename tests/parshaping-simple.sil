\begin[papersize=a7]{document}
\nofolios
\use[module=packages.lorem]
\begin{script}

local testshape = {
  { 50, 30, nil },
  { 50, 60, nil },
  { nil, 120, nil },
  { nil, 30, 40 },
  { nil, nil, nil },
  { 50, nil, 50 },
}

SILE.settings:set("linebreak.tolerance", 2000)
SILE.settings:set("document.parindent", 0)
SILE.settings:set("linebreak.parshape", true)

SILE.linebreak.parShape = function (self, line)
  local shape = testshape[line]
	if shape then
		return shape[1], shape[2], shape[3]
	else
		return nil, nil, nil
	end
end

SILE.call("lorem", { words = 20 })
SILE.call("par")
SILE.call("lorem", { words = 30 })

\end{script}
\end{document}
